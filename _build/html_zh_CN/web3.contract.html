

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>合约 &mdash; web3.py 7.13.0 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/toggle.css?v=255ab139" />
      <link rel="stylesheet" type="text/css" href="_static/css/banner.css?v=3691352e" />


      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=e1264167"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/translations.js?v=beaddf03"></script>
      <script src="_static/js/matomo.js?v=9fa6000d"></script>
      <script src="_static/js/toggle.js?v=6fec00b1"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="事件和日志" href="filters.html" />
    <link rel="prev" title="交易" href="transactions.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="index.html" class="icon icon-home">
            web3.py
          </a>
<div role="search">
  <form
    id="rtd-search-form"
    class="wy-form"
    action="search.html"
    method="get"
  >
    <input type="text" name="q" placeholder="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


<div class="search-banner-wrapper">
  <a href="https://forms.gle/PAyV3QH9XH6WrzSaA">
    <img
      src="_static/banner/feedback.png"
      alt="Feedback Form"
    />
  </a>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">快速开始</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">概览</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">发布说明</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">指南</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="providers.html">提供者</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.eth.account.html">账户</a></li>
<li class="toctree-l1"><a class="reference internal" href="transactions.html">交易</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">合约</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interacting-with-deployed-contracts">Interacting with deployed contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contract-deployment-example">Contract Deployment Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contract-factories">Contract Factories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract"><code class="docutils literal notranslate"><span class="pre">Contract</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#properties">Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.address"><code class="docutils literal notranslate"><span class="pre">Contract.address</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.abi"><code class="docutils literal notranslate"><span class="pre">Contract.abi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.bytecode"><code class="docutils literal notranslate"><span class="pre">Contract.bytecode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.bytecode_runtime"><code class="docutils literal notranslate"><span class="pre">Contract.bytecode_runtime</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.decode_tuples"><code class="docutils literal notranslate"><span class="pre">Contract.decode_tuples</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.functions"><code class="docutils literal notranslate"><span class="pre">Contract.functions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.events"><code class="docutils literal notranslate"><span class="pre">Contract.events</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#methods">Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.constructor"><code class="docutils literal notranslate"><span class="pre">Contract.constructor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.events.your_event_name.create_filter"><code class="docutils literal notranslate"><span class="pre">Contract.events.your_event_name.create_filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.events.your_event_name.build_filter"><code class="docutils literal notranslate"><span class="pre">Contract.events.your_event_name.build_filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.encode_abi"><code class="docutils literal notranslate"><span class="pre">Contract.encode_abi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.all_events"><code class="docutils literal notranslate"><span class="pre">Contract.all_events()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_event_by_signature"><code class="docutils literal notranslate"><span class="pre">Contract.get_event_by_signature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.find_events_by_name"><code class="docutils literal notranslate"><span class="pre">Contract.find_events_by_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_event_by_name"><code class="docutils literal notranslate"><span class="pre">Contract.get_event_by_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.find_events_by_selector"><code class="docutils literal notranslate"><span class="pre">Contract.find_events_by_selector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_event_by_selector"><code class="docutils literal notranslate"><span class="pre">Contract.get_event_by_selector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.find_events_by_topic"><code class="docutils literal notranslate"><span class="pre">Contract.find_events_by_topic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_event_by_topic"><code class="docutils literal notranslate"><span class="pre">Contract.get_event_by_topic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.all_functions"><code class="docutils literal notranslate"><span class="pre">Contract.all_functions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_function_by_signature"><code class="docutils literal notranslate"><span class="pre">Contract.get_function_by_signature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.find_functions_by_name"><code class="docutils literal notranslate"><span class="pre">Contract.find_functions_by_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_function_by_name"><code class="docutils literal notranslate"><span class="pre">Contract.get_function_by_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_function_by_selector"><code class="docutils literal notranslate"><span class="pre">Contract.get_function_by_selector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.find_functions_by_args"><code class="docutils literal notranslate"><span class="pre">Contract.find_functions_by_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.get_function_by_args"><code class="docutils literal notranslate"><span class="pre">Contract.get_function_by_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#disabling-strict-checks-for-bytes-types">Disabling Strict Checks for Bytes Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contract-functions">Contract Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.ContractFunction"><code class="docutils literal notranslate"><span class="pre">ContractFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#attributes">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.ContractFunction.transact"><code class="docutils literal notranslate"><span class="pre">ContractFunction.transact()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.ContractFunction.call"><code class="docutils literal notranslate"><span class="pre">ContractFunction.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.ContractFunction.estimate_gas"><code class="docutils literal notranslate"><span class="pre">ContractFunction.estimate_gas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.ContractFunction.build_transaction"><code class="docutils literal notranslate"><span class="pre">ContractFunction.build_transaction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fallback-function">Fallback Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.Contract.fallback.call"><code class="docutils literal notranslate"><span class="pre">Contract.fallback.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.Contract.fallback.estimate_gas"><code class="docutils literal notranslate"><span class="pre">Contract.fallback.estimate_gas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.Contract.fallback.transact"><code class="docutils literal notranslate"><span class="pre">Contract.fallback.transact()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.Contract.fallback.build_transaction"><code class="docutils literal notranslate"><span class="pre">Contract.fallback.build_transaction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#contract-events">Contract Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.ContractEvent"><code class="docutils literal notranslate"><span class="pre">ContractEvent</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web3.contract.ContractEvent.process_log"><code class="docutils literal notranslate"><span class="pre">ContractEvent.process_log()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#event-log-object">Event Log Object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.Contract.decode_function_input"><code class="docutils literal notranslate"><span class="pre">Contract.decode_function_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#contractcaller">ContractCaller</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web3.contract.ContractCaller"><code class="docutils literal notranslate"><span class="pre">ContractCaller</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#working-with-an-erc-20-token-contract">Working with an ERC-20 Token Contract</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-contract-factory">Creating the contract factory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#querying-token-metadata">Querying token metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#query-account-balances">Query account balances</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sending-tokens">Sending tokens</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-an-approval-for-external-transfers">Creating an approval for external transfers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-an-external-transfer">Performing an external transfer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-a-struct-as-a-function-argument">Using a struct as a function argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="#invoke-ambiguous-contract-functions">Invoke Ambiguous Contract Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ccip-read-support-for-offchain-lookup">CCIP Read support for offchain lookup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contract-unit-tests-in-python">Contract Unit Tests in Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">事件和日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="subscriptions.html">事件订阅</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">中间件</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Web3 内部实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="ens_overview.html">以太坊名称服务 (ENS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">故障排除</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">迁移指南</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="web3.main.html">Web3 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.eth.html">web3.eth API</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.beacon.html">Beacon API</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.net.html">Net API</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.geth.html">Geth API</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.tracing.html">Tracing API</a></li>
<li class="toctree-l1"><a class="reference internal" href="web3.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="gas_price.html">Gas Price API</a></li>
<li class="toctree-l1"><a class="reference internal" href="ens.html">ENS API</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Constants</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">社区</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源和学习材料</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">行为准则</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">web3.py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">合约</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/web3.contract.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="contracts">
<span id="id1"></span><h1>合约<a class="headerlink" href="#contracts" title="Link to this heading"></a></h1>
<p id="module-web3.contract">Smart contracts are programs deployed to the Ethereum network. See the
<a class="reference external" href="https://ethereum.org/en/developers/docs/smart-contracts">ethereum.org docs</a>
for a proper introduction.</p>
<section id="interacting-with-deployed-contracts">
<h2>Interacting with deployed contracts<a class="headerlink" href="#interacting-with-deployed-contracts" title="Link to this heading"></a></h2>
<p>In order to use an existing contract, you'll need its deployed address and its ABI.
Both can be found using block explorers, like Etherscan. Once you instantiate a contract
instance, you can read data and execute transactions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure w3, e.g., w3 = Web3(...)</span>
<span class="n">address</span> <span class="o">=</span> <span class="s1">&#39;0x1f9840a85d5aF5bf1D1762F925BDADdC4201F988&#39;</span>
<span class="n">abi</span> <span class="o">=</span> <span class="s1">&#39;[{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;minter_&quot;,&quot;type&quot;:&quot;address&quot;},...&#39;</span>
<span class="n">contract_instance</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">abi</span><span class="p">)</span>

<span class="c1"># read state:</span>
<span class="n">contract_instance</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">storedValue</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="c1"># 42</span>

<span class="c1"># update state:</span>
<span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract_instance</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">updateValue</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="contract-deployment-example">
<span id="contract-example"></span><h2>Contract Deployment Example<a class="headerlink" href="#contract-deployment-example" title="Link to this heading"></a></h2>
<p>To run this example, you will need to install a few extra features:</p>
<ul class="simple">
<li><p>The sandbox node provided by eth-tester. You can install it with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span><span class="s2">&quot;web3[tester]&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">py-solc-x</span></code>. This is the supported route to installing the solidity compiler <code class="docutils literal notranslate"><span class="pre">solc</span></code>. You can install it with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>py-solc-x
</pre></div>
</div>
<p>After <code class="docutils literal notranslate"><span class="pre">py-solc-x</span></code> is installed, you will need to install a version of <code class="docutils literal notranslate"><span class="pre">solc</span></code>. You can install the latest version via a new REPL with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">solcx</span><span class="w"> </span><span class="kn">import</span> <span class="n">install_solc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">install_solc</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You should now be set up to compile and deploy a contract.</p>
<p>The following example runs through these steps:</p>
<ol class="arabic simple">
<li><p>Compile Solidity contract into bytecode and an ABI</p></li>
<li><p>Initialize a Contract instance</p></li>
<li><p>Deploy the contract using the Contract instance to initiate a transaction</p></li>
<li><p>Interact with the contract functions using the Contract instance</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">web3</span><span class="w"> </span><span class="kn">import</span> <span class="n">Web3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">solcx</span><span class="w"> </span><span class="kn">import</span> <span class="n">compile_source</span>

<span class="go"># Solidity source code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compiled_sol</span> <span class="o">=</span> <span class="n">compile_source</span><span class="p">(</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="sd">    pragma solidity &gt;0.5.0;</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">    contract Greeter {</span>
<span class="gp">... </span><span class="sd">        string public greeting;</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">        constructor() public {</span>
<span class="gp">... </span><span class="sd">            greeting = &#39;Hello&#39;;</span>
<span class="gp">... </span><span class="sd">        }</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">        function setGreeting(string memory _greeting) public {</span>
<span class="gp">... </span><span class="sd">            greeting = _greeting;</span>
<span class="gp">... </span><span class="sd">        }</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">        function greet() view public returns (string memory) {</span>
<span class="gp">... </span><span class="sd">            return greeting;</span>
<span class="gp">... </span><span class="sd">        }</span>
<span class="gp">... </span><span class="sd">    }</span>
<span class="gp">... </span><span class="sd">    &#39;&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;abi&#39;</span><span class="p">,</span> <span class="s1">&#39;bin&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>

<span class="go"># retrieve the contract interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract_id</span><span class="p">,</span> <span class="n">contract_interface</span> <span class="o">=</span> <span class="n">compiled_sol</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>

<span class="go"># get bytecode / bin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">contract_interface</span><span class="p">[</span><span class="s1">&#39;bin&#39;</span><span class="p">]</span>

<span class="go"># get abi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abi</span> <span class="o">=</span> <span class="n">contract_interface</span><span class="p">[</span><span class="s1">&#39;abi&#39;</span><span class="p">]</span>

<span class="go"># web3.py instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">Web3</span><span class="o">.</span><span class="n">EthereumTesterProvider</span><span class="p">())</span>

<span class="go"># set pre-funded account as sender</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">default_account</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Greeter</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">abi</span><span class="o">=</span><span class="n">abi</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">=</span><span class="n">bytecode</span><span class="p">)</span>

<span class="go"># Submit the transaction that deploys the contract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">Greeter</span><span class="o">.</span><span class="n">constructor</span><span class="p">()</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>

<span class="go"># Wait for the transaction to be mined, and get the transaction receipt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greeter</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">address</span><span class="o">=</span><span class="n">tx_receipt</span><span class="o">.</span><span class="n">contractAddress</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">abi</span><span class="o">=</span><span class="n">abi</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greeter</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">&#39;Hello&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">greeter</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setGreeting</span><span class="p">(</span><span class="s1">&#39;Nihao&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">greeter</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">&#39;Nihao&#39;</span>
</pre></div>
</div>
</section>
<section id="contract-factories">
<h2>Contract Factories<a class="headerlink" href="#contract-factories" title="Link to this heading"></a></h2>
<p>These factories are not intended to be initialized directly.
Instead, create contract objects using the <a class="reference internal" href="web3.eth.html#web3.eth.Eth.contract" title="web3.eth.Eth.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">w3.eth.contract()</span></code></a>
method. By default, the contract factory is <a class="reference internal" href="#web3.contract.Contract" title="web3.contract.Contract"><code class="xref py py-class docutils literal notranslate"><span class="pre">Contract</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="web3.contract.Contract">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">web3.contract.</span></span><span class="sig-name descname"><span class="pre">Contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">address</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract" title="Link to this definition"></a></dt>
<dd><p>Contract provides a default interface for deploying and interacting with
Ethereum smart contracts.</p>
<p>The address parameter can be a hex address or an ENS name, like <code class="docutils literal notranslate"><span class="pre">mycontract.eth</span></code>.</p>
</dd></dl>

</section>
<section id="properties">
<h2>Properties<a class="headerlink" href="#properties" title="Link to this heading"></a></h2>
<p>Each Contract Factory exposes the following properties.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.address">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">address</span></span><a class="headerlink" href="#web3.contract.Contract.address" title="Link to this definition"></a></dt>
<dd><p>The hexadecimal encoded 20-byte address of the contract, or an ENS name.
May be <code class="docutils literal notranslate"><span class="pre">None</span></code> if not provided during factory creation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.abi">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">abi</span></span><a class="headerlink" href="#web3.contract.Contract.abi" title="Link to this definition"></a></dt>
<dd><p>The contract <code class="docutils literal notranslate"><span class="pre">abi</span></code>, or Application Binary Interface, specifies how a contract can
be interacted with. Without an <code class="docutils literal notranslate"><span class="pre">abi</span></code>, the contract cannot be decoded. The <code class="docutils literal notranslate"><span class="pre">abi</span></code>
enables the Contract instance to expose functions and events as object properties.</p>
<p>For further details, see the <a class="reference external" href="https://docs.soliditylang.org/en/develop/abi-spec.html">Solidity ABI specification</a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.bytecode">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">bytecode</span></span><a class="headerlink" href="#web3.contract.Contract.bytecode" title="Link to this definition"></a></dt>
<dd><p>The contract bytecode string.  May be <code class="docutils literal notranslate"><span class="pre">None</span></code> if not provided during
factory creation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.bytecode_runtime">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">bytecode_runtime</span></span><a class="headerlink" href="#web3.contract.Contract.bytecode_runtime" title="Link to this definition"></a></dt>
<dd><p>The runtime part of the contract bytecode string.  May be <code class="docutils literal notranslate"><span class="pre">None</span></code> if not
provided during factory creation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.decode_tuples">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">decode_tuples</span></span><a class="headerlink" href="#web3.contract.Contract.decode_tuples" title="Link to this definition"></a></dt>
<dd><p>If a Tuple/Struct is returned by a contract function, this flag defines whether
to apply the field names from the ABI to the returned data.
If False, the returned value will be a normal Python <code class="docutils literal notranslate"><span class="pre">Tuple</span></code>. If True, the returned
value will be a Python <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code> of the class <code class="docutils literal notranslate"><span class="pre">ABIDecodedNamedTuple</span></code>.</p>
<p>NamedTuples have some restrictions regarding field names.
web3.py sets <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code>'s <code class="docutils literal notranslate"><span class="pre">rename=True</span></code>, so disallowed field names may be
different than expected. See the <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple">Python docs</a>
for more information.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code> if not provided during factory creation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.functions">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">functions</span></span><a class="headerlink" href="#web3.contract.Contract.functions" title="Link to this definition"></a></dt>
<dd><p>This provides access to contract functions as attributes.  For example:
<code class="docutils literal notranslate"><span class="pre">myContract.functions.MyMethod()</span></code>.  The exposed contract functions are classes of the
type <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="web3.contract.Contract.events">
<span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">events</span></span><a class="headerlink" href="#web3.contract.Contract.events" title="Link to this definition"></a></dt>
<dd><p>This provides access to contract events as attributes.  For example:
<code class="docutils literal notranslate"><span class="pre">myContract.events.MyEvent()</span></code>.  The exposed contract events are classes of the
type <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a>.</p>
</dd></dl>

</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h2>
<p>Method doctests use the following ABI and bytecode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bytecode</span> <span class="o">=</span> <span class="s1">&#39;6060604052341561000c57fe5b604051602080610acb833981016040528080519060200190919050505b620f42408114151561003b5760006000fd5b670de0b6b3a76400008102600281905550600254600060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b505b610a27806100a46000396000f30060606040523615610097576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde0314610099578063095ea7b31461013257806318160ddd1461018957806323b872dd146101af578063313ce5671461022557806370a082311461025157806395d89b411461029b578063a9059cbb14610334578063dd62ed3e1461038b575bfe5b34156100a157fe5b6100a96103f4565b60405180806020018281038252838181518152602001915080519060200190808383600083146100f8575b8051825260208311156100f8576020820191506020810190506020830392506100d4565b505050905090810190601f1680156101245780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561013a57fe5b61016f600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061042e565b604051808215151515815260200191505060405180910390f35b341561019157fe5b610199610521565b6040518082815260200191505060405180910390f35b34156101b757fe5b61020b600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610527565b604051808215151515815260200191505060405180910390f35b341561022d57fe5b610235610791565b604051808260ff1660ff16815260200191505060405180910390f35b341561025957fe5b610285600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610796565b6040518082815260200191505060405180910390f35b34156102a357fe5b6102ab6107e0565b60405180806020018281038252838181518152602001915080519060200190808383600083146102fa575b8051825260208311156102fa576020820191506020810190506020830392506102d6565b505050905090810190601f1680156103265780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561033c57fe5b610371600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061081a565b604051808215151515815260200191505060405180910390f35b341561039357fe5b6103de600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610973565b6040518082815260200191505060405180910390f35b604060405190810160405280600981526020017f54657374546f6b656e000000000000000000000000000000000000000000000081525081565b600081600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925846040518082815260200191505060405180910390a3600190505b92915050565b60025481565b600081600060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410806105f1575081600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054105b156105fc5760006000fd5b81600060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254019250508190555081600060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555081600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055508273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040518082815260200191505060405180910390a3600190505b9392505050565b601281565b6000600060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b919050565b604060405190810160405280600481526020017f544553540000000000000000000000000000000000000000000000000000000081525081565b600081600060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156108695760006000fd5b81600060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555081600060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040518082815260200191505060405180910390a3600190505b92915050565b6000600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b929150505600a165627a7a723058205071371ee2a4a1be3c96e77d939cdc26161a256fdd638efc08bd33dfc65d3b850029&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abi</span> <span class="o">=</span> <span class="s1">&#39;[{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;name&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;_value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;approve&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;totalSupply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;_to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;_value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transferFrom&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;decimals&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint8&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_owner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;balanceOf&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;symbol&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;_value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;_spender&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;allowance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;_totalSupply&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;constructor&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Approval&quot;,&quot;type&quot;:&quot;event&quot;}]&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">abi</span><span class="o">=</span><span class="n">abi</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">=</span><span class="n">bytecode</span><span class="p">)</span>
</pre></div>
</div>
<p>Each Contract Factory exposes the following methods.</p>
<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.constructor">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">constructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs).transact(transaction=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.constructor" title="Link to this definition"></a></dt>
<dd><p>Construct and deploy a contract by sending a new public transaction.</p>
<p>If provided <code class="docutils literal notranslate"><span class="pre">transaction</span></code> should be a dictionary conforming to the
<code class="docutils literal notranslate"><span class="pre">web3.eth.send_transaction(transaction)</span></code> method.  This value may not
contain the keys <code class="docutils literal notranslate"><span class="pre">data</span></code> or <code class="docutils literal notranslate"><span class="pre">to</span></code>.</p>
<p>If the contract takes constructor parameters they should be provided as
positional arguments or keyword arguments.</p>
<p>If any of the arguments specified in the ABI are an <code class="docutils literal notranslate"><span class="pre">address</span></code> type, they
will accept ENS names.</p>
<p>If a <code class="docutils literal notranslate"><span class="pre">gas</span></code> value is not provided, then the <code class="docutils literal notranslate"><span class="pre">gas</span></code> value for the
deployment transaction will be created using the <code class="docutils literal notranslate"><span class="pre">web3.eth.estimate_gas()</span></code>
method.</p>
<p>Returns the transaction hash for the deploy transaction.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deploy_txn</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">constructor</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;gas&#39;</span><span class="p">:</span> <span class="mi">899000</span><span class="p">,</span> <span class="s1">&#39;gasPrice&#39;</span><span class="p">:</span> <span class="n">Web3</span><span class="o">.</span><span class="n">to_wei</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;gwei&#39;</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txn_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction_receipt</span><span class="p">(</span><span class="n">deploy_txn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txn_receipt</span><span class="p">[</span><span class="s1">&#39;contractAddress&#39;</span><span class="p">]</span>
<span class="go">&#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">constructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs).estimate_gas(transaction=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_identifier=None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Estimate gas for constructing and deploying the contract.</p>
<p>This method behaves the same as the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Contract.constructor(*args,</span> <span class="pre">**kwargs).transact()</span></code> method,
with transaction details being passed into the end portion of the
function call, and function arguments being passed into the first portion.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">block_identifier</span></code> parameter is passed directly to the call at the end portion
of the function call.</p>
<p>Returns the amount of gas consumed which can be used as a gas estimate for
executing this transaction publicly.</p>
<p>Returns the gas needed to deploy the contract.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">constructor</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span><span class="o">.</span><span class="n">estimate_gas</span><span class="p">()</span>
<span class="go">664971</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">constructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs).build_transaction(transaction=None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Construct the contract deploy transaction bytecode data.</p>
<p>If the contract takes constructor parameters they should be provided as
positional arguments or keyword arguments.</p>
<p>If any of the <code class="docutils literal notranslate"><span class="pre">args</span></code> specified in the ABI are an <code class="docutils literal notranslate"><span class="pre">address</span></code> type, they
will accept ENS names.</p>
<p>Returns the transaction dictionary that you can pass to send_transaction method.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>  <span class="s1">&#39;gas&#39;</span><span class="p">:</span> <span class="mi">664971</span><span class="p">,</span>
<span class="gp">... </span>  <span class="s1">&#39;chainId&#39;</span><span class="p">:</span> <span class="mi">131277322940537</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract_data</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">constructor</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span><span class="o">.</span><span class="n">build_transaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">send_transaction</span><span class="p">(</span><span class="n">contract_data</span><span class="p">)</span>
<span class="go">HexBytes(&#39;0x40c51804800dee88e14e69826cfe51bc5f25f61935331e8aa6d8d7771fb36350&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method" id="contract-create-filter">
<dt class="sig sig-object py" id="web3.contract.Contract.events.your_event_name.create_filter">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.events.your_event_name.</span></span><span class="sig-name descname"><span class="pre">create_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argument_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.events.your_event_name.create_filter" title="Link to this definition"></a></dt>
<dd><p>Creates a new event filter, an instance of <a class="reference internal" href="filters.html#web3.utils.filters.LogFilter" title="web3.utils.filters.LogFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">web3.utils.filters.LogFilter</span></code></a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">from_block</span></code> is a mandatory field. Defines the starting block (exclusive) filter block range. It can be either the starting block number, or 'latest' for the last mined block, or 'pending' for unmined transactions. In the case of <code class="docutils literal notranslate"><span class="pre">from_block</span></code>, 'latest' and 'pending' set the 'latest' or 'pending' block as a static value for the starting filter block.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_block</span></code> optional. Defaults to 'latest'. Defines the ending block (inclusive) in the filter block range.  Special values 'latest' and 'pending' set a dynamic range that always includes the 'latest' or 'pending' blocks for the filter's upper block range.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> optional. Defaults to the contract address. The filter matches the event logs emanating from <code class="docutils literal notranslate"><span class="pre">address</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">argument_filters</span></code>, optional. Expects a dictionary of argument names and values. When provided event logs are filtered for the event argument values. Event arguments can be both indexed or unindexed. Indexed values will be translated to their corresponding topic arguments. Unindexed arguments will be filtered using a regular expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">topics</span></code> optional, accepts the standard JSON-RPC topics argument.  See the JSON-RPC documentation for <a class="reference external" href="https://github.com/ethereum/wiki/wiki/JSON-RPC#eth_newfilter">eth_newFilter</a> more information on the <code class="docutils literal notranslate"><span class="pre">topics</span></code> parameters.</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">create_filter</span><span class="p">(</span><span class="n">from_block</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.events.your_event_name.build_filter">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.events.your_event_name.</span></span><span class="sig-name descname"><span class="pre">build_filter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.events.your_event_name.build_filter" title="Link to this definition"></a></dt>
<dd><p>Creates a EventFilterBuilder instance with the event abi, and the contract address if called from a deployed contract instance.  The EventFilterBuilder provides a convenient way to construct the filter parameters with value checking against the event abi. It allows for defining multiple match values or of single values through the match_any and match_single methods.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">build_filter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">from_block</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">match_any</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">match_single</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">match_single</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_instance</span> <span class="o">=</span> <span class="n">filter_builder</span><span class="o">.</span><span class="n">deploy</span><span class="p">(</span><span class="n">w3</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">deploy</span></code> method returns a <a class="reference internal" href="filters.html#web3.utils.filters.LogFilter" title="web3.utils.filters.LogFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">web3.utils.filters.LogFilter</span></code></a> instance from the filter parameters generated by the filter builder. Defining multiple match values for array arguments can be accomplished easily with the filter builder:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">build_filter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">match_any</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The filter builder blocks already defined filter parameters from being changed.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">build_filter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">from_block</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_builder</span><span class="o">.</span><span class="n">from_block</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">web3.exceptions.Web3ValueError</span>: <span class="n">from_block is already set to &#39;latest&#39;. Resetting filter parameters is not permitted</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.encode_abi">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">encode_abi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abi_element_identifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.encode_abi" title="Link to this definition"></a></dt>
<dd><p>Encodes the arguments using the Ethereum ABI for the contract function that
matches the given <code class="docutils literal notranslate"><span class="pre">abi_element_identifier</span></code> and arguments <code class="docutils literal notranslate"><span class="pre">args</span></code>. The <code class="docutils literal notranslate"><span class="pre">data</span></code> parameter
defaults to the function selector.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">encode_abi</span><span class="p">(</span><span class="s2">&quot;approve&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">])</span>
<span class="go">&#39;0x095ea7b30000000000000000000000007e5f4552091a69125d5dfcb7b8c2659029395bdf000000000000000000000000000000000000000000000000000000000000000a&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.all_events">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">all_events</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.all_events" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all the events present in a Contract where every event is
an instance of <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">all_events</span><span class="p">()</span>
<span class="go">[&lt;Event Transfer(address,address,uint256)&gt;, &lt;Event Approval(address,address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_event_by_signature">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_event_by_signature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_event_by_signature" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct event with matching signature. Returns an instance of
<a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a> upon finding a match. Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no
match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_event_by_signature</span><span class="p">(</span><span class="s1">&#39;Transfer(address,address,uint256)&#39;</span><span class="p">)</span>
<span class="go">&lt;Event Transfer(address,address,uint256)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.find_events_by_name">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">find_events_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.find_events_by_name" title="Link to this definition"></a></dt>
<dd><p>Searches for all events matching the provided name. Returns a list of matching
events where every event is an instance of <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a>. Returns an
empty list when no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">find_events_by_name</span><span class="p">(</span><span class="s1">&#39;Transfer&#39;</span><span class="p">)</span>
<span class="go">[&lt;Event Transfer(address,address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_event_by_name">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_event_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_event_by_name" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct event matching the name. Returns an instance of
<a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a> upon finding a match. Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no
match is found or if multiple matches are found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_event_by_name</span><span class="p">(</span><span class="s1">&#39;Approval&#39;</span><span class="p">)</span>
<span class="go">&lt;Event Approval(address,address,uint256)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.find_events_by_selector">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">find_events_by_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.find_events_by_selector" title="Link to this definition"></a></dt>
<dd><p>Searches for all events matching the provided selector. Returns a list of matching
events where every event is an instance of <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a>. Returns an
empty list when no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">find_events_by_selector</span><span class="p">(</span><span class="s1">&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class="p">)</span>
<span class="go">[&lt;Event Approval(address,address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_event_by_selector">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_event_by_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_event_by_selector" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct event with matching selector.
The selector can be a hexadecimal string, bytes or int.
Returns an instance of <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a> upon finding a match.
Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_event_by_selector</span><span class="p">(</span><span class="s1">&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class="p">)</span>
<span class="go">&lt;Event Approval(address,address,uint256)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_event_by_selector</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x8c</span><span class="s1">[</span><span class="se">\xe1\xe5\xeb\xec</span><span class="s1">}[</span><span class="se">\xd1</span><span class="s1">OqB}</span><span class="se">\x1e\x84\xf3\xdd\x03\x14\xc0\xf7\xb2</span><span class="s1">)</span><span class="se">\x1e</span><span class="s1">[ </span><span class="se">\n\xc8\xc7\xc3\xb9</span><span class="s1">%&#39;</span><span class="p">)</span>
<span class="go">&lt;Event Approval(address,address,uint256)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_event_by_selector</span><span class="p">(</span><span class="mh">0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925</span><span class="p">)</span>
<span class="go">&lt;Event Approval(address,address,uint256)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.find_events_by_topic">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">find_events_by_topic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.find_events_by_topic" title="Link to this definition"></a></dt>
<dd><p>Searches for all events matching the provided topic. Returns a list of matching
events where every event is an instance of <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a>. Returns an
empty list when no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">find_events_by_topic</span><span class="p">(</span><span class="s1">&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class="p">)</span>
<span class="go">[&lt;Event Approval(address,address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_event_by_topic">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_event_by_topic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_event_by_topic" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct event with matching topic.
The topic is a hexadecimal string.
Returns an instance of <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a> upon finding a match.
Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_event_by_topic</span><span class="p">(</span><span class="s1">&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class="p">)</span>
<span class="go">&lt;Event Approval(address,address,uint256)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.all_functions">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">all_functions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.all_functions" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all the functions present in a Contract where every function is
an instance of <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">all_functions</span><span class="p">()</span>
<span class="go">[&lt;Function allowance(address,address)&gt;, &lt;Function approve(address,uint256)&gt;, &lt;Function balanceOf(address)&gt;, &lt;Function decimals()&gt;, &lt;Function name()&gt;, &lt;Function symbol()&gt;, &lt;Function totalSupply()&gt;, &lt;Function transfer(address,uint256)&gt;, &lt;Function transferFrom(address,address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_function_by_signature">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_function_by_signature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_function_by_signature" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct function with matching signature. Returns an instance of
<a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> upon finding a match. Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no
match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_function_by_signature</span><span class="p">(</span><span class="s1">&#39;approve(address,uint256)&#39;</span><span class="p">)</span>
<span class="go">&lt;Function approve(address,uint256)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.find_functions_by_name">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">find_functions_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.find_functions_by_name" title="Link to this definition"></a></dt>
<dd><p>Searches for all functions matching the name. Returns a list of matching functions
where every function is an instance of <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a>. Returns an empty
list when no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">find_functions_by_name</span><span class="p">(</span><span class="s1">&#39;transferFrom&#39;</span><span class="p">)</span>
<span class="go">[&lt;Function transferFrom(address,address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_function_by_name">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_function_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_function_by_name" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct function with matching name. Returns an instance of
<a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> upon finding a match. Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no
match is found or if multiple matches are found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_function_by_name</span><span class="p">(</span><span class="s1">&#39;decimals&#39;</span><span class="p">)</span>
<span class="go">&lt;Function decimals()&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_function_by_selector">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_function_by_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_function_by_selector" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct function with matching selector.
The selector can be a hexadecimal string, bytes or int.
Returns an instance of <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> upon finding a match.
Raises <code class="docutils literal notranslate"><span class="pre">Web3ValueError</span></code> if no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_function_by_selector</span><span class="p">(</span><span class="s1">&#39;0xdd62ed3e&#39;</span><span class="p">)</span>
<span class="go">&lt;Function allowance(address,address)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_function_by_selector</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xdd</span><span class="s1">b</span><span class="se">\xed</span><span class="s1">&gt;&#39;</span><span class="p">)</span>
<span class="go">&lt;Function allowance(address,address)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_function_by_selector</span><span class="p">(</span><span class="mh">0xdd62ed3e</span><span class="p">)</span>
<span class="go">&lt;Function allowance(address,address)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.find_functions_by_args">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">find_functions_by_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.find_functions_by_args" title="Link to this definition"></a></dt>
<dd><p>Searches for all function with matching args. Returns a list of matching functions
where every function is an instance of <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a>. Returns an empty
list when no match is found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">find_functions_by_args</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10000</span><span class="p">)</span>
<span class="go">[&lt;Function approve(address,uint256)&gt;, &lt;Function transfer(address,uint256)&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.get_function_by_args">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">get_function_by_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.get_function_by_args" title="Link to this definition"></a></dt>
<dd><p>Searches for a distinct function with matching args. Returns an instance of
<a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> upon finding a match. Raises <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if no
match is found or if multiple matches are found.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">get_function_by_args</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10000</span><span class="p">)</span>
<span class="go">&lt;Function transferFrom(address,address,uint256)&gt;</span>
</pre></div>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<p><code class="docutils literal notranslate"><span class="pre">Contract</span></code> methods <code class="docutils literal notranslate"><span class="pre">all_functions</span></code>, <code class="docutils literal notranslate"><span class="pre">get_function_by_signature</span></code>, <code class="docutils literal notranslate"><span class="pre">find_functions_by_name</span></code>,
<code class="docutils literal notranslate"><span class="pre">get_function_by_name</span></code>, <code class="docutils literal notranslate"><span class="pre">get_function_by_selector</span></code>, <code class="docutils literal notranslate"><span class="pre">find_functions_by_args</span></code> and
<code class="docutils literal notranslate"><span class="pre">get_function_by_args</span></code> can only be used when abi is provided to the contract.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>web3.py rejects the initialization of contracts that have more than one function
with the same selector or signature.
eg. <code class="docutils literal notranslate"><span class="pre">blockHashAddendsInexpansible(uint256)</span></code> and <code class="docutils literal notranslate"><span class="pre">blockHashAskewLimitary(uint256)</span></code> have the
same selector value equal to <code class="docutils literal notranslate"><span class="pre">0x00000000</span></code>. A contract containing both of these functions
will be rejected.</p>
</div>
</section>
<section id="disabling-strict-checks-for-bytes-types">
<span id="disable-strict-byte-check"></span><h2>Disabling Strict Checks for Bytes Types<a class="headerlink" href="#disabling-strict-checks-for-bytes-types" title="Link to this heading"></a></h2>
<p>By default, web3 is strict when it comes to hex and bytes values, as of <code class="docutils literal notranslate"><span class="pre">v6</span></code>.
If an abi specifies a byte size, but the value that gets passed in is not the specified
size, web3 will invalidate the value. For example, if an abi specifies a type of
<code class="docutils literal notranslate"><span class="pre">bytes4</span></code>, web3 will invalidate the following values:</p>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">Invalid byte and hex strings with strict (default) bytes4 type checking</span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Reason</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p></td>
<td><p>Needs to be prefixed with a &quot;0x&quot; to be interpreted as an empty hex string</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>Wrong type</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'ah'</span></code></p></td>
<td><p>String is not valid hex</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'1234'</span></code></p></td>
<td><p>Needs to either be a bytestring (b'1234') or be a hex value of the right size, prefixed with 0x (in this case: '0x31323334')</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">b''</span></code></p></td>
<td><p>Needs to have exactly 4 bytes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b'ab'</span></code></p></td>
<td><p>Needs to have exactly 4 bytes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'0xab'</span></code></p></td>
<td><p>Needs to have exactly 4 bytes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'0x6162636464'</span></code></p></td>
<td><p>Needs to have exactly 4 bytes</p></td>
</tr>
</tbody>
</table>
<p>However, you may want to be less strict with acceptable values for bytes types.
This may prove useful if you trust that values coming through are what they are
meant to be with respect to the ABI. In this case, the automatic padding might be
convenient for inferred types. For this, you can set the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">w3.strict_bytes_type_checking()</span></code> flag to <code class="docutils literal notranslate"><span class="pre">False</span></code>, which is available on the
Web3 instance. A Web3 instance which has this flag set to <code class="docutils literal notranslate"><span class="pre">False</span></code> will have a less
strict set of rules on which values are accepted. A <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type will allow values as
a hex string, a bytestring, or a regular Python string that can be decoded as a hex.
0x-prefixed hex strings are also not required.</p>
<blockquote>
<div><ul class="simple">
<li><p>A Python string that is not prefixed with <code class="docutils literal notranslate"><span class="pre">0x</span></code> is valid.</p></li>
<li><p>A bytestring whose length is less than the specified byte size is valid.</p></li>
</ul>
</div></blockquote>
<table class="docutils align-default" id="id10">
<caption><span class="caption-text">Valid byte and hex strings for a non-strict bytes4 type</span><a class="headerlink" href="#id10" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Normalizes to</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'\x00\x00\x00\x00'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'0x'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'\x00\x00\x00\x00'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">b''</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'\x00\x00\x00\x00'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b'ab'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'ab\x00\x00'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'0xab'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'\xab\x00\x00\x00'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'1234'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'\x124\x00\x00'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'0x61626364'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'abcd'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'1234'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'1234'</span></code></p></td>
</tr>
</tbody>
</table>
<p>Taking the following contract code as an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#  pragma solidity &gt;=0.4.22 &lt;0.6.0;</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="c1">#   contract ArraysContract {</span>
<span class="gp">... </span><span class="c1">#      bytes2[] public bytes2Value;</span>

<span class="go">... #      constructor(bytes2[] memory _bytes2Value) public {</span>
<span class="go">... #          bytes2Value = _bytes2Value;</span>
<span class="go">... #      }</span>

<span class="go">... #      function setBytes2Value(bytes2[] memory _bytes2Value) public {</span>
<span class="go">... #          bytes2Value = _bytes2Value;</span>
<span class="go">... #      }</span>

<span class="go">... #      function getBytes2Value() public view returns (bytes2[] memory) {</span>
<span class="go">... #          return bytes2Value;</span>
<span class="go">... #      }</span>
<span class="go">... #  }</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># abi = &quot;...&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bytecode = &quot;6080...&quot;</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract_instance</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">abi</span><span class="o">=</span><span class="n">abi</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">=</span><span class="n">bytecode</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">arrays_contract_instance</span><span class="o">.</span><span class="n">constructor</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;bb&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">address</span><span class="o">=</span><span class="n">tx_receipt</span><span class="o">.</span><span class="n">contractAddress</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">abi</span><span class="o">=</span><span class="n">abi</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">getBytes2Value</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">[b&#39;bb&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set value with appropriate byte size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBytes2Value</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;aa&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;gas&#39;</span><span class="p">:</span> <span class="mi">420000</span><span class="p">,</span> <span class="s2">&quot;maxPriorityFeePerGas&quot;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;maxFeePerGas&quot;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">})</span>
<span class="go">HexBytes(&#39;0xcb95151142ea56dbf2753d70388aef202a7bb5a1e323d448bc19f1d2e1fe3dc9&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">getBytes2Value</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">[b&#39;aa&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># trying to set value without appropriate size (bytes2) is not valid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBytes2Value</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;b&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">web3.exceptions.MismatchedABI</span><span class="w">:</span>
<span class="x">Could not identify the intended function with name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check value is still b&#39;aa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">getBytes2Value</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">[b&#39;aa&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># disabling strict byte checking...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w3</span><span class="o">.</span><span class="n">strict_bytes_type_checking</span> <span class="o">=</span> <span class="kc">False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">arrays_contract_instance</span><span class="o">.</span><span class="n">constructor</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;b&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">address</span><span class="o">=</span><span class="n">tx_receipt</span><span class="o">.</span><span class="n">contractAddress</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">abi</span><span class="o">=</span><span class="n">abi</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check value is zero-padded... i.e. b&#39;b\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">getBytes2Value</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">[b&#39;b\x00&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set the flag back to True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w3</span><span class="o">.</span><span class="n">strict_bytes_type_checking</span> <span class="o">=</span> <span class="kc">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBytes2Value</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">web3.exceptions.MismatchedABI</span><span class="w">:</span>
<span class="x">Could not identify the intended function with name</span>
</pre></div>
</div>
</section>
<section id="contract-functions">
<span id="id2"></span><h2>Contract Functions<a class="headerlink" href="#contract-functions" title="Link to this heading"></a></h2>
<p>The named functions exposed through the <a class="reference internal" href="#web3.contract.Contract.functions" title="web3.contract.Contract.functions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Contract.functions</span></code></a> property are
of the ContractFunction type. This class is not to be used directly,
but instead through <a class="reference internal" href="#web3.contract.Contract.functions" title="web3.contract.Contract.functions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Contract.functions</span></code></a>.</p>
<p>For example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span> <span class="o">=</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">contract_address</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">contract_abi</span><span class="p">)</span>
<span class="n">twentyone</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>If you have the function name in a variable, you might prefer this alternative:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">func_to_call</span> <span class="o">=</span> <span class="s1">&#39;multiply7&#39;</span>
<span class="n">contract_func</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="n">func_to_call</span><span class="p">]</span>
<span class="n">twentyone</span> <span class="o">=</span> <span class="n">contract_func</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>You can also interact with contract functions without parentheses if the function doesn't
take any arguments. For example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">return13</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">return13</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">13</span>
</pre></div>
</div>
</div></blockquote>
<p>In cases where functions are overloaded and use arguments of similar types, a function
may resolve to an undesired function when using the method syntax. For example, given
two functions with the same name that take a single argument of differing types of
<code class="docutils literal notranslate"><span class="pre">bytes</span></code> and <code class="docutils literal notranslate"><span class="pre">bytes32</span></code>. When a reference to <code class="xref py py-meth docutils literal notranslate"><span class="pre">contract.functions.setBytes(b'1')()</span></code>
is used, the function will resolve as the one that takes <code class="docutils literal notranslate"><span class="pre">bytes</span></code>. If a value is passed
that was meant to be 32 bytes but the given argument was off by one, the function
reference will still use the one that takes <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
<p>When in doubt, use explicit function references to the signature. Use bracket notation
(<code class="xref py py-meth docutils literal notranslate"><span class="pre">contract.functions[&quot;setBytes(bytes32)&quot;](b'')()</span></code>) or the contract API
<cite>contract.get_function_by_signature(&quot;setBytes(bytes32)&quot;)</cite> to retrieve the desired
function. This will ensure an exception is raised if the argument is not strictly
32 bytes in length.</p>
<dl class="py class">
<dt class="sig sig-object py" id="web3.contract.ContractFunction">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">web3.contract.</span></span><span class="sig-name descname"><span class="pre">ContractFunction</span></span><a class="headerlink" href="#web3.contract.ContractFunction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> class provides attributes for each function. Access the function attributes through <cite>Contract.functions.myMethod</cite>.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).abi_element_identifier</span></span></dt>
<dd><p>The signature of the function assigned to the class <code class="docutils literal notranslate"><span class="pre">__name__</span></code> during initialization.
Fallback and Receive functions will be assigned as classes <code class="xref py py-class docutils literal notranslate"><span class="pre">FallbackFn</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">ReceiveFn</span></code> respectively.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).name</span></span></dt>
<dd><p>A string representing the function, receive or fallback name.</p>
<p>Use <code class="xref py py-attr docutils literal notranslate"><span class="pre">ContractFunction.signature</span></code> when the function arguments are needed.</p>
<p>This is an alias of <code class="xref py py-attr docutils literal notranslate"><span class="pre">ContractFunction.fn_name</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).signature</span></span></dt>
<dd><p>A string representing the function, receive or fallback signature.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).selector</span></span></dt>
<dd><p>A HexStr encoded from the first four bytes of the function signature.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).abi</span></span></dt>
<dd><p>The function ABI with the type, name, inputs and outputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).arguments</span></span></dt>
<dd><p>A tuple of all function inputs, normalized so that <cite>kwargs</cite> themselves are
flattened into a tuple as returned by <code class="xref py py-meth docutils literal notranslate"><span class="pre">eth_utils.abi.get_normalized_abi_inputs()</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).argument_names</span></span></dt>
<dd><p>The function input names.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractFunction.myMethod(*args,</span> <span class="pre">**kwargs).argument_types</span></span></dt>
<dd><p>The function input types.</p>
</dd></dl>

</section>
<section id="id3">
<h3>Methods<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> provides methods to interact with contract functions.
Positional and keyword arguments supplied to the contract function subclass
will be used to find the contract function by signature,
and forwarded to the contract function when applicable.</p>
<p><a class="reference external" href="https://eips.ethereum.org/EIPS/eip-3668">EIP-3668</a> introduced support for the <code class="docutils literal notranslate"><span class="pre">OffchainLookup</span></code> revert /
CCIP Read support. CCIP Read is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> for calls by default, as recommended in EIP-3668. This is done via a
global <code class="docutils literal notranslate"><span class="pre">global_ccip_read_enabled</span></code> flag on the provider. If raising the <code class="docutils literal notranslate"><span class="pre">OffchainLookup</span></code> revert is preferred for a
specific call, the <code class="docutils literal notranslate"><span class="pre">ccip_read_enabled</span></code> flag on the call may be set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># raises the revert instead of handling the offchain lookup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">revertsWithOffchainLookup</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">ccip_read_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">*** web3.exceptions.OffchainLookup</span>
</pre></div>
</div>
</div></blockquote>
<p>Disabling CCIP Read support can be useful if a transaction needs to be sent to the callback function. In such cases,
&quot;preflighting&quot; with an <code class="docutils literal notranslate"><span class="pre">eth_call</span></code>, handling the <code class="docutils literal notranslate"><span class="pre">OffchainLookup</span></code>, and sending the data via a transaction may be
necessary. See <a class="reference internal" href="#ccip-read-example"><span class="std std-ref">CCIP Read support for offchain lookup</span></a> in the examples section for how to preflight a transaction with a contract call.</p>
<p>Similarly, if CCIP Read is globally set to <code class="docutils literal notranslate"><span class="pre">False</span></code> via the <code class="docutils literal notranslate"><span class="pre">global_ccip_read_enabled</span></code> flag on the provider, it may be
enabled on a per-call basis - overriding the global flag. This ensures only explicitly enabled calls will handle the
<code class="docutils literal notranslate"><span class="pre">OffchainLookup</span></code> revert appropriately.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># global flag set to `False`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w3</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">global_ccip_read_enabled</span> <span class="o">=</span> <span class="kc">False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># does not raise the revert since explicitly enabled on the call:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">revertsWithOffchainLookup</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">ccip_read_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>If the function called results in a <code class="docutils literal notranslate"><span class="pre">revert</span></code> error, a <code class="docutils literal notranslate"><span class="pre">ContractLogicError</span></code> will be raised.
If there is an error message with the error, web3.py attempts to parse the
message that comes back and return it to the user as the error string.
As of v6.3.0, the raw data is also returned and
can be accessed via the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute on <code class="docutils literal notranslate"><span class="pre">ContractLogicError</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.ContractFunction.transact">
<span class="sig-prename descclassname"><span class="pre">ContractFunction.</span></span><span class="sig-name descname"><span class="pre">transact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.ContractFunction.transact" title="Link to this definition"></a></dt>
<dd><p>Execute the specified function by sending a new public transaction.</p>
<p>Refer to the following invocation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myMethod</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</pre></div>
</div>
<p>The first portion of the function call <code class="docutils literal notranslate"><span class="pre">myMethod(*args,</span> <span class="pre">**kwargs)</span></code>
selects the appropriate contract function based on the name and provided
argument.  Arguments can be provided as positional arguments, keyword
arguments, or a mix of the two.</p>
<p>The end portion of this function call <code class="docutils literal notranslate"><span class="pre">transact(transaction)</span></code> takes a
single parameter which should be a python dictionary conforming to
the same format as the <code class="docutils literal notranslate"><span class="pre">web3.eth.send_transaction(transaction)</span></code> method.
This dictionary may not contain the keys <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<p>If any of the <code class="docutils literal notranslate"><span class="pre">args</span></code> or <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> specified in the ABI are an <code class="docutils literal notranslate"><span class="pre">address</span></code> type, they
will accept ENS names.</p>
<p>If a <code class="docutils literal notranslate"><span class="pre">gas</span></code> value is not provided, then the <code class="docutils literal notranslate"><span class="pre">gas</span></code> value for the
method transaction will be created using the <code class="docutils literal notranslate"><span class="pre">web3.eth.estimate_gas()</span></code>
method.</p>
<p>Returns the transaction hash.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">12345</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="go">&quot;0x4e3a3754410177e6937ef1f84bba68ea139e8d1a2258c5f85db9f1cd715a1bdd&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.ContractFunction.call">
<span class="sig-prename descclassname"><span class="pre">ContractFunction.</span></span><span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_identifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.ContractFunction.call" title="Link to this definition"></a></dt>
<dd><p>Call a contract function, executing the transaction locally using the
<code class="docutils literal notranslate"><span class="pre">eth_call</span></code> API.  This will not create a new public transaction.</p>
<p>Refer to the following invocation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myMethod</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</pre></div>
</div>
<p>This method behaves the same as the <a class="reference internal" href="#web3.contract.ContractFunction.transact" title="web3.contract.ContractFunction.transact"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ContractFunction.transact()</span></code></a> method,
with transaction details being passed into the end portion of the
function call, and function arguments being passed into the first portion.</p>
<p>Returns the return value of the executed function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="go">12345  # the token balance for `web3.eth.accounts[0]`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="go">54321  # the token balance for the account `web3.eth.accounts[1]`</span>
</pre></div>
</div>
<p>You can call the method at a historical block using <code class="docutils literal notranslate"><span class="pre">block_identifier</span></code>. Some examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can call your contract method at a block number:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># or a number of blocks back from pending,</span>
<span class="c1"># in this case, the block just before the latest block:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># or a block hash:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=</span><span class="s1">&#39;0x4ff4a38b278ab49f7739d3a4ed4e12714386a9fdf72192f2e8f7da7822f10b4d&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;O</span><span class="se">\xf4\xa3\x8b\&#39;\x8a\xb4\x9f</span><span class="s1">w9</span><span class="se">\xd3\xa4\xed</span><span class="s1">N</span><span class="se">\x12</span><span class="s1">qC</span><span class="se">\x86\xa9\xfd\xf7</span><span class="s1">!</span><span class="se">\x92\xf2\xe8\xf7\xda</span><span class="s1">x&quot;</span><span class="se">\xf1\x0b</span><span class="s1">M&#39;</span><span class="p">)</span>

<span class="c1"># Latest is the default, so this is redundant:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">)</span>

<span class="c1"># You can check the state after your pending transactions (if supported by your node):</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myBalance</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=</span><span class="s1">&#39;pending&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Passing the <code class="docutils literal notranslate"><span class="pre">block_identifier</span></code> parameter for past block numbers requires that your Ethereum API node
is running in the more expensive archive node mode. Normally synced Ethereum nodes will fail with
a &quot;missing trie node&quot; error, because Ethereum node may have purged the past state from its database.
<a class="reference external" href="https://ethereum.stackexchange.com/a/84200/620">More information about archival nodes here</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.ContractFunction.estimate_gas">
<span class="sig-prename descclassname"><span class="pre">ContractFunction.</span></span><span class="sig-name descname"><span class="pre">estimate_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_identifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.ContractFunction.estimate_gas" title="Link to this definition"></a></dt>
<dd><p>Call a contract function, executing the transaction locally using the
<code class="docutils literal notranslate"><span class="pre">eth_call</span></code> API.  This will not create a new public transaction.</p>
<p>Refer to the following invocation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myMethod</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">estimate_gas</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</pre></div>
</div>
<p>This method behaves the same as the <a class="reference internal" href="#web3.contract.ContractFunction.transact" title="web3.contract.ContractFunction.transact"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ContractFunction.transact()</span></code></a> method,
with transaction details being passed into the end portion of the
function call, and function arguments being passed into the first portion.</p>
<p>Returns the amount of gas consumed which can be used as a gas estimate for
executing this transaction publicly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">estimate_gas</span><span class="p">()</span>
<span class="go">42650</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">block_identifier</span></code> is not enabled in geth nodes,
hence passing a value of <code class="docutils literal notranslate"><span class="pre">block_identifier</span></code> when connected to a geth
nodes would result in an error like:  <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">{'code':</span> <span class="pre">-32602,</span> <span class="pre">'message':</span> <span class="pre">'too</span> <span class="pre">many</span> <span class="pre">arguments,</span> <span class="pre">want</span> <span class="pre">at</span> <span class="pre">most</span> <span class="pre">1'}</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.ContractFunction.build_transaction">
<span class="sig-prename descclassname"><span class="pre">ContractFunction.</span></span><span class="sig-name descname"><span class="pre">build_transaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.ContractFunction.build_transaction" title="Link to this definition"></a></dt>
<dd><p>Builds a transaction dictionary based on the contract function call specified.</p>
<p>Refer to the following invocation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myMethod</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">build_transaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</pre></div>
</div>
<p>This method behaves the same as the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Contract.transact()</span></code> method,
with transaction details being passed into the end portion of the
function call, and function arguments being passed into the first portion.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><cite>nonce</cite> is not returned as part of the transaction dictionary unless it is
specified in the first portion of the function call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">math_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">build_transaction</span><span class="p">({</span><span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
<p>You may use <code class="xref py py-meth docutils literal notranslate"><span class="pre">getTransactionCount()</span></code> to get the current nonce
for an account. Therefore a shortcut for producing a transaction dictionary with
nonce included looks like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">math_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">build_transaction</span><span class="p">({</span><span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction_count</span><span class="p">(</span><span class="s1">&#39;0xF5...&#39;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<p>Returns a transaction dictionary. This transaction dictionary can then be sent using
<a class="reference internal" href="web3.eth.html#web3.eth.Eth.send_transaction" title="web3.eth.Eth.send_transaction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_transaction()</span></code></a>.</p>
<p>Additionally, the dictionary may be used for offline transaction signing using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sign_transaction()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">math_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">build_transaction</span><span class="p">({</span><span class="s1">&#39;maxFeePerGas&#39;</span><span class="p">:</span> <span class="mi">2000000000</span><span class="p">,</span> <span class="s1">&#39;maxPriorityFeePerGas&#39;</span><span class="p">:</span> <span class="mi">1000000000</span><span class="p">})</span>
<span class="go">{</span>
<span class="go">    &#39;to&#39;: &#39;0x582AC4D8929f58c217d4a52aDD361AE470a8a4cD&#39;,</span>
<span class="go">    &#39;data&#39;: &#39;0x7cf5dab00000000000000000000000000000000000000000000000000000000000000005&#39;,</span>
<span class="go">    &#39;value&#39;: 0,</span>
<span class="go">    &#39;gas&#39;: 43242,</span>
<span class="go">    &#39;maxFeePerGas&#39;: 2000000000,</span>
<span class="go">    &#39;maxPriorityFeePerGas&#39;: 1000000000,</span>
<span class="go">    &#39;chainId&#39;: 1</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="fallback-function">
<span id="id4"></span><h3>Fallback Function<a class="headerlink" href="#fallback-function" title="Link to this heading"></a></h3>
<blockquote>
<div><p>The Contract Factory also offers an API to interact with the fallback function, which supports four methods like
normal functions:</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.fallback.call">
<span class="sig-prename descclassname"><span class="pre">Contract.fallback.</span></span><span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.fallback.call" title="Link to this definition"></a></dt>
<dd><p>Call fallback function, executing the transaction locally using the
<code class="docutils literal notranslate"><span class="pre">eth_call</span></code> API.  This will not create a new public transaction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.fallback.estimate_gas">
<span class="sig-prename descclassname"><span class="pre">Contract.fallback.</span></span><span class="sig-name descname"><span class="pre">estimate_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.fallback.estimate_gas" title="Link to this definition"></a></dt>
<dd><p>Call fallback function and return the gas estimation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.fallback.transact">
<span class="sig-prename descclassname"><span class="pre">Contract.fallback.</span></span><span class="sig-name descname"><span class="pre">transact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.fallback.transact" title="Link to this definition"></a></dt>
<dd><p>Execute fallback function by sending a new public transaction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.fallback.build_transaction">
<span class="sig-prename descclassname"><span class="pre">Contract.fallback.</span></span><span class="sig-name descname"><span class="pre">build_transaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.fallback.build_transaction" title="Link to this definition"></a></dt>
<dd><p>Builds a transaction dictionary based on the contract fallback function call.</p>
</dd></dl>

</section>
</section>
<section id="contract-events">
<h2>Contract Events<a class="headerlink" href="#contract-events" title="Link to this heading"></a></h2>
<p>The named events exposed through the <a class="reference internal" href="#web3.contract.Contract.events" title="web3.contract.Contract.events"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Contract.events</span></code></a> property are of the ContractEvent type. This class is not to be used directly, but instead through <a class="reference internal" href="#web3.contract.Contract.events" title="web3.contract.Contract.events"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Contract.events</span></code></a>.</p>
<p>For example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span> <span class="o">=</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">contract_address</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">contract_abi</span><span class="p">)</span>
<span class="n">tx_hash</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myFunction</span><span class="p">()</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>
<span class="n">receipt</span> <span class="o">=</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="n">myContract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">process_receipt</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="web3.contract.ContractEvent">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">web3.contract.</span></span><span class="sig-name descname"><span class="pre">ContractEvent</span></span><a class="headerlink" href="#web3.contract.ContractEvent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<section id="id5">
<h3>Attributes<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a> class provides attributes for each event. Access the event attributes through <cite>Contract.events.MyEvent</cite>.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).abi_element_identifier</span></span></dt>
<dd><p>The signature of the event assigned to the class <code class="docutils literal notranslate"><span class="pre">__name__</span></code> during initialization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).name</span></span></dt>
<dd><p>A string representing the event, receive or fallback name.</p>
<p>Use <code class="xref py py-attr docutils literal notranslate"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).signature</span></code> when the event arguments are needed.</p>
<p>This is an alias of <code class="xref py py-attr docutils literal notranslate"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).event_name</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).signature</span></span></dt>
<dd><p>A string representing the event signature.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).abi</span></span></dt>
<dd><p>The event ABI with the type, name, inputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).argument_names</span></span></dt>
<dd><p>The event input names.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).argument_types</span></span></dt>
<dd><p>The event input types.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ContractEvent.MyEvent(*args,</span> <span class="pre">**kwargs).topic</span></span></dt>
<dd><p>The event topic represented by a hex encoded string from the keccak signature.</p>
</dd></dl>

</section>
<section id="id6">
<h3>Methods<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="#web3.contract.ContractEvent" title="web3.contract.ContractEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractEvent</span></code></a> provides methods to interact with contract events. Positional and keyword arguments supplied to the contract event subclass will be used to find the contract event by signature.</p>
<dl class="py method" id="contract-get-logs">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ContractEvent.</span></span><span class="sig-name descname"><span class="pre">get_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argument_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Fetches all logs for a given event within the specified block range or block hash.</p>
<p>Returns a list of decoded event logs sorted by <code class="docutils literal notranslate"><span class="pre">logIndex</span></code>.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">argument_filters</span></code> is an optional dictionary argument that can be used to filter
for logs where the event's argument values match the values provided in the
dictionary. The keys must match the event argument names as they exist in the ABI.
The values can either be a single value or a list of values to match against. If a
list is provided, the logs will be filtered for any logs that match any of the
values in the list. Indexed arguments are filtered pre-call by building specific
<code class="docutils literal notranslate"><span class="pre">topics</span></code> to filter for. Non-indexed arguments are filtered by the library after
the logs are fetched from the node.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_contract</span> <span class="o">=</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">contract_address</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">contract_abi</span><span class="p">)</span>

<span class="c1"># get ``MyEvent`` logs from block 1337 to block 2337 where the value for the</span>
<span class="c1"># event argument &quot;eventArg1&quot; is either 1, 2, or 3</span>
<span class="n">my_contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
    <span class="n">argument_filters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;eventArg1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="n">from_block</span><span class="o">=</span><span class="mi">1337</span><span class="p">,</span>
    <span class="n">to_block</span><span class="o">=</span><span class="mi">2337</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method" id="process-receipt">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ContractEvent.</span></span><span class="sig-name descname"><span class="pre">process_receipt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction_receipt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">WARN</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Extracts the pertinent logs from a transaction receipt.</p>
<p>If there are no errors, <code class="docutils literal notranslate"><span class="pre">process_receipt</span></code> returns a tuple of <a class="reference internal" href="#event-log-object"><span class="std std-ref">Event Log Objects</span></a>, emitted from the event (e.g. <code class="docutils literal notranslate"><span class="pre">MyEvent</span></code>),
with decoded output.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;to&#39;</span><span class="p">:</span><span class="n">contract_address</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rich_logs</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">process_receipt</span><span class="p">(</span><span class="n">tx_receipt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rich_logs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;args&#39;</span><span class="p">]</span>
<span class="go">{&#39;myArg&#39;: 12345}</span>
</pre></div>
</div>
<p>If there are errors, the logs will be handled differently depending on the flag that is passed in:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">WARN</span></code> (default) - logs a warning to the console for the log that has an error, and discards the log. Returns any logs that are able to be processed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STRICT</span></code> - stops all processing and raises the error encountered.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IGNORE</span></code> - returns any raw logs that raised an error with an added &quot;errors&quot; field, along with any other logs were able to be processed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DISCARD</span></code> - silently discards any logs that have errors, and returns processed logs that don't have errors.</p></li>
</ul>
</div></blockquote>
<p>An event log error flag needs to be imported from <code class="docutils literal notranslate"><span class="pre">web3/logs.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;to&#39;</span><span class="p">:</span><span class="n">contract_address</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_logs</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">process_receipt</span><span class="p">(</span><span class="n">tx_receipt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_logs</span>
<span class="go">(</span>
<span class="go">   AttributeDict({</span>
<span class="go">       &#39;args&#39;: AttributeDict({}),</span>
<span class="go">       &#39;event&#39;: &#39;MyEvent&#39;,</span>
<span class="go">       &#39;logIndex&#39;: 0,</span>
<span class="go">       &#39;transactionIndex&#39;: 0,</span>
<span class="go">       &#39;transactionHash&#39;: HexBytes(&#39;0xfb95ccb6ab39e19821fb339dee33e7afe2545527725b61c64490a5613f8d11fa&#39;),</span>
<span class="go">       &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go">       &#39;blockHash&#39;: HexBytes(&#39;0xd74c3e8bdb19337987b987aee0fa48ed43f8f2318edfc84e3a8643e009592a68&#39;),</span>
<span class="go">       &#39;blockNumber&#39;: 3</span>
<span class="go">   })</span>
<span class="go">)</span>


<span class="go"># Or, if there were errors encountered during processing:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">web3.logs</span><span class="w"> </span><span class="kn">import</span> <span class="n">STRICT</span><span class="p">,</span> <span class="n">IGNORE</span><span class="p">,</span> <span class="n">DISCARD</span><span class="p">,</span> <span class="n">WARN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_logs</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">process_receipt</span><span class="p">(</span><span class="n">tx_receipt</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">IGNORE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_logs</span>
<span class="go">(</span>
<span class="go">    AttributeDict({</span>
<span class="go">        &#39;type&#39;: &#39;mined&#39;,</span>
<span class="go">        &#39;logIndex&#39;: 0,</span>
<span class="go">        &#39;transactionIndex&#39;: 0,</span>
<span class="go">        &#39;transactionHash&#39;: HexBytes(&#39;0x01682095d5abb0270d11a31139b9a1f410b363c84add467004e728ec831bd529&#39;),</span>
<span class="go">        &#39;blockHash&#39;: HexBytes(&#39;0x92abf9325a3959a911a2581e9ea36cba3060d8b293b50e5738ff959feb95258a&#39;),</span>
<span class="go">        &#39;blockNumber&#39;: 5,</span>
<span class="go">        &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go">        &#39;data&#39;: &#39;0x0000000000000000000000000000000000000000000000000000000000003039&#39;,</span>
<span class="go">        &#39;topics&#39;: [</span>
<span class="go">            HexBytes(&#39;0xf70fe689e290d8ce2b2a388ac28db36fbb0e16a6d89c6804c461f65a1b40bb15&#39;)</span>
<span class="go">        ],</span>
<span class="go">        &#39;errors&#39;: LogTopicError(&#39;Expected 1 log topics.  Got 0&#39;)})</span>
<span class="go">   })</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_logs</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">process_receipt</span><span class="p">(</span><span class="n">tx_receipt</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">DISCARD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">processed_logs</span> <span class="o">==</span> <span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.ContractEvent.process_log">
<span class="sig-prename descclassname"><span class="pre">ContractEvent.</span></span><span class="sig-name descname"><span class="pre">process_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.ContractEvent.process_log" title="Link to this definition"></a></dt>
<dd><p>Similar to <a class="reference internal" href="#process-receipt">process_receipt</a>, but only processes one log at a time, instead of a whole transaction receipt.
Will return a single <a class="reference internal" href="#event-log-object"><span class="std std-ref">Event Log Object</span></a> if there are no errors encountered during processing. If an error is encountered during processing, it will be raised.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;to&#39;</span><span class="p">:</span><span class="n">contract_address</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_to_process</span> <span class="o">=</span> <span class="n">tx_receipt</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_log</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">MyEvent</span><span class="p">()</span><span class="o">.</span><span class="n">process_log</span><span class="p">(</span><span class="n">log_to_process</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processed_log</span>
<span class="go">AttributeDict({</span>
<span class="go">    &#39;args&#39;: AttributeDict({}),</span>
<span class="go">    &#39;event&#39;: &#39;MyEvent&#39;,</span>
<span class="go">    &#39;logIndex&#39;: 0,</span>
<span class="go">    &#39;transactionIndex&#39;: 0,</span>
<span class="go">    &#39;transactionHash&#39;: HexBytes(&#39;0xfb95ccb6ab39e19821fb339dee33e7afe2545527725b61c64490a5613f8d11fa&#39;),</span>
<span class="go">    &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go">    &#39;blockHash&#39;: HexBytes(&#39;0xd74c3e8bdb19337987b987aee0fa48ed43f8f2318edfc84e3a8643e009592a68&#39;),</span>
<span class="go">    &#39;blockNumber&#39;: 3</span>
<span class="go">})</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="event-log-object">
<span id="id7"></span><h3>Event Log Object<a class="headerlink" href="#event-log-object" title="Link to this heading"></a></h3>
<blockquote>
<div><p>The Event Log Object is a python dictionary with the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code>: Dictionary - The arguments coming from the event.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">event</span></code>: String - The event name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logIndex</span></code>: Number - integer of the log index position in the block.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transactionIndex</span></code>: Number - integer of the transactions index position
log was created from.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transactionHash</span></code>: String, 32 Bytes - hash of the transactions this log
was created from.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code>: String, 32 Bytes - address from which this log originated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blockHash</span></code>: String, 32 Bytes - hash of the block where this log was
in. null when it's pending.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blockNumber</span></code>: Number - the block number where this log was in. null
when it's pending.</p></li>
</ul>
</div></blockquote>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transfer_filter</span> <span class="o">=</span> <span class="n">my_token_contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">create_filter</span><span class="p">(</span><span class="n">from_block</span><span class="o">=</span><span class="s2">&quot;0x0&quot;</span><span class="p">,</span> <span class="n">argument_filters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="s1">&#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transfer_filter</span><span class="o">.</span><span class="n">get_new_entries</span><span class="p">()</span>
<span class="go">[AttributeDict({&#39;args&#39;: AttributeDict({&#39;from&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;to&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;value&#39;: 10}),</span>
<span class="go"> &#39;event&#39;: &#39;Transfer&#39;,</span>
<span class="go"> &#39;logIndex&#39;: 0,</span>
<span class="go"> &#39;transactionIndex&#39;: 0,</span>
<span class="go"> &#39;transactionHash&#39;: HexBytes(&#39;0x9da859237e7259832b913d51cb128c8d73d1866056f7a41b52003c953e749678&#39;),</span>
<span class="go"> &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go"> &#39;blockHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;blockNumber&#39;: 2})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transfer_filter</span><span class="o">.</span><span class="n">get_new_entries</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;gas&#39;</span><span class="p">:</span> <span class="mi">899000</span><span class="p">,</span> <span class="s1">&#39;gasPrice&#39;</span><span class="p">:</span> <span class="mi">1000000000</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transfer_filter</span><span class="o">.</span><span class="n">get_new_entries</span><span class="p">()</span>
<span class="go">[AttributeDict({&#39;args&#39;: AttributeDict({&#39;from&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;to&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;value&#39;: 10}),</span>
<span class="go"> &#39;event&#39;: &#39;Transfer&#39;,</span>
<span class="go"> &#39;logIndex&#39;: 0,</span>
<span class="go"> &#39;transactionIndex&#39;: 0,</span>
<span class="go"> &#39;transactionHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go"> &#39;blockHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;blockNumber&#39;: 3})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transfer_filter</span><span class="o">.</span><span class="n">get_all_entries</span><span class="p">()</span>
<span class="go">[AttributeDict({&#39;args&#39;: AttributeDict({&#39;from&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;to&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;value&#39;: 10}),</span>
<span class="go"> &#39;event&#39;: &#39;Transfer&#39;,</span>
<span class="go"> &#39;logIndex&#39;: 0,</span>
<span class="go"> &#39;transactionIndex&#39;: 0,</span>
<span class="go"> &#39;transactionHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go"> &#39;blockHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;blockNumber&#39;: 2}),</span>
<span class="go"> AttributeDict({&#39;args&#39;: AttributeDict({&#39;from&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;to&#39;: &#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;,</span>
<span class="go"> &#39;value&#39;: 10}),</span>
<span class="go"> &#39;event&#39;: &#39;Transfer&#39;,</span>
<span class="go"> &#39;logIndex&#39;: 0,</span>
<span class="go"> &#39;transactionIndex&#39;: 0,</span>
<span class="go"> &#39;transactionHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;address&#39;: &#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;,</span>
<span class="go"> &#39;blockHash&#39;: HexBytes(&#39;...&#39;),</span>
<span class="go"> &#39;blockNumber&#39;: 3})]</span>
</pre></div>
</div>
</section>
</section>
<section id="utils">
<h2>Utils<a class="headerlink" href="#utils" title="Link to this heading"></a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="web3.contract.Contract.decode_function_input">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Contract.</span></span><span class="sig-name descname"><span class="pre">decode_function_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web3.contract.Contract.decode_function_input" title="Link to this definition"></a></dt>
<dd><p>Decodes the transaction data used to invoke a smart contract function, and returns
<a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a> and decoded parameters as <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transaction</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">get_transaction</span><span class="p">(</span><span class="s1">&#39;0x5798fbc45e3b63832abc4984b0f3574a13545f415dd672cd8540cd71f735db56&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transaction</span><span class="o">.</span><span class="n">input</span>
<span class="go">&#39;0x612e45a3000000000000000000000000b656b2a9c3b2416437a811e07466ca712f5a5b5a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000093a80000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000116c6f6e656c792c20736f206c6f6e656c7900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">decode_function_input</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="go">(&lt;Function newProposal(address,uint256,string,bytes,uint256,bool)&gt;,</span>
<span class="go"> {&#39;_recipient&#39;: &#39;0xB656b2a9c3b2416437A811e07466cA712F5a5b5a&#39;,</span>
<span class="go">  &#39;_amount&#39;: 0,</span>
<span class="go">  &#39;_description&#39;: b&#39;lonely, so lonely&#39;,</span>
<span class="go">  &#39;_transactionData&#39;: b&#39;&#39;,</span>
<span class="go">  &#39;_debatingPeriod&#39;: 604800,</span>
<span class="go">  &#39;_newCurator&#39;: True})</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="contractcaller">
<h2>ContractCaller<a class="headerlink" href="#contractcaller" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="web3.contract.ContractCaller">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">web3.contract.</span></span><span class="sig-name descname"><span class="pre">ContractCaller</span></span><a class="headerlink" href="#web3.contract.ContractCaller" title="Link to this definition"></a></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">ContractCaller</span></code> class provides an API to call functions in a contract. This class
is not to be used directly, but instead through <code class="docutils literal notranslate"><span class="pre">Contract.caller</span></code>.</p>
<p>There are a number of different ways to invoke the <code class="docutils literal notranslate"><span class="pre">ContractCaller</span></code>.</p>
<p>For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myContract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">ABI</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span>
<span class="go">21</span>
</pre></div>
</div>
<p>It can also be invoked using parentheses:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">caller</span><span class="p">()</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span>
<span class="go">21</span>
</pre></div>
</div>
<p>And a transaction dictionary, with or without the <code class="docutils literal notranslate"><span class="pre">transaction</span></code> keyword.
You can also optionally include a block identifier. For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">from_address</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">caller</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">from_address</span><span class="p">})</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span>
<span class="go">21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">caller</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">from_address</span><span class="p">})</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span>
<span class="go">21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span> <span class="o">=</span> <span class="n">myContract</span><span class="o">.</span><span class="n">caller</span><span class="p">(</span><span class="n">block_identifier</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply7</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twentyone</span>
<span class="go">21</span>
</pre></div>
</div>
<p>Like <a class="reference internal" href="#web3.contract.ContractFunction" title="web3.contract.ContractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractFunction</span></code></a>, <a class="reference internal" href="#web3.contract.ContractCaller" title="web3.contract.ContractCaller"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractCaller</span></code></a>
provides methods to interact with contract functions.
Positional and keyword arguments supplied to the contract caller subclass
will be used to find the contract function by signature,
and forwarded to the contract function when applicable.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="working-with-an-erc-20-token-contract">
<h3>Working with an ERC-20 Token Contract<a class="headerlink" href="#working-with-an-erc-20-token-contract" title="Link to this heading"></a></h3>
<p>Most fungible tokens on the Ethereum blockchain conform to the <a class="reference external" href="https://github.com/ethereum/ERCs/blob/master/ERCS/erc-20.md">ERC-20</a>
standard.  This section of the guide covers interacting with an existing token
contract which conforms to this standard.</p>
<p>In this guide we will interact with an existing token contract that we have
already deployed to a local testing chain.  This guide assumes:</p>
<ol class="arabic simple">
<li><p>An existing token contract at a known address.</p></li>
<li><p>Access to the proper <code class="docutils literal notranslate"><span class="pre">ABI</span></code> for the given contract.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">web3.main.Web3</span></code> instance connected to a provider with an unlocked account which can send transactions.</p></li>
</ol>
<section id="creating-the-contract-factory">
<h4>Creating the contract factory<a class="headerlink" href="#creating-the-contract-factory" title="Link to this heading"></a></h4>
<p>First we need to create a contract instance with the address of our token
contract and the <code class="docutils literal notranslate"><span class="pre">ERC-20</span></code> ABI.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">contract_address</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">ABI</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">address</span>
<span class="go">&#39;0xF2E246BB76DF876Cef8b38ae84130F4F55De395b&#39;</span>
</pre></div>
</div>
</section>
<section id="querying-token-metadata">
<h4>Querying token metadata<a class="headerlink" href="#querying-token-metadata" title="Link to this heading"></a></h4>
<p>Each token will have a total supply which represents the total number of tokens
in circulation.  In this example we've initialized the token contract to have 1
million tokens.  Since this token contract is setup to have 18 decimal places,
the raw total supply returned by the contract is going to have 18 additional
decimal places.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">&#39;TestToken&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">&#39;TEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimals</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">decimals</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimals</span>
<span class="go">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DECIMALS</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">decimals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">totalSupply</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span> <span class="o">//</span> <span class="n">DECIMALS</span>
<span class="go">1000000</span>
</pre></div>
</div>
</section>
<section id="query-account-balances">
<h4>Query account balances<a class="headerlink" href="#query-account-balances" title="Link to this heading"></a></h4>
<p>Next we can query some account balances using the contract's <code class="docutils literal notranslate"><span class="pre">balanceOf</span></code>
function.  The token contract we are using starts with a single account which
we'll refer to as <code class="docutils literal notranslate"><span class="pre">alice</span></code> holding all of the tokens.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="s1">&#39;0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="s1">&#39;0x2B5AD5c4795c026514f8317c7a215E218DcCD6cF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_balance</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_balance</span>
<span class="go">1000000000000000000000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_balance</span> <span class="o">//</span> <span class="n">DECIMALS</span>
<span class="go">1000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</section>
<section id="sending-tokens">
<h4>Sending tokens<a class="headerlink" href="#sending-tokens" title="Link to this heading"></a></h4>
<p>Next we can transfer some tokens from <code class="docutils literal notranslate"><span class="pre">alice</span></code> to <code class="docutils literal notranslate"><span class="pre">bob</span></code> using the contract's
<code class="docutils literal notranslate"><span class="pre">transfer</span></code> function.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">alice</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">999999999999999999999900</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">100</span>
</pre></div>
</div>
</section>
<section id="creating-an-approval-for-external-transfers">
<h4>Creating an approval for external transfers<a class="headerlink" href="#creating-an-approval-for-external-transfers" title="Link to this heading"></a></h4>
<p>Alice could also <em>approve</em> someone else to spend tokens from her account using
the <code class="docutils literal notranslate"><span class="pre">approve</span></code> function.  We can also query how many tokens we're approved to
spend using the <code class="docutils literal notranslate"><span class="pre">allowance</span></code> function.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">allowance</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">alice</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">allowance</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">200</span>
</pre></div>
</div>
</section>
<section id="performing-an-external-transfer">
<h4>Performing an external transfer<a class="headerlink" href="#performing-an-external-transfer" title="Link to this heading"></a></h4>
<p>When someone has an allowance they can transfer those tokens using the
<code class="docutils literal notranslate"><span class="pre">transferFrom</span></code> function.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">allowance</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_hash</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">transferFrom</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">({</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">bob</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">allowance</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">125</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="n">bob</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">175</span>
</pre></div>
</div>
</section>
</section>
<section id="using-a-struct-as-a-function-argument">
<h3>Using a struct as a function argument<a class="headerlink" href="#using-a-struct-as-a-function-argument" title="Link to this heading"></a></h3>
<p>web3.py accepts struct arguments as dictionaries. This format also supports nested structs.
Let's take a look at a quick example. Given the following Solidity contract:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>contract Example {
  address addr;

  struct S1 {
    address a1;
    address a2;
  }

  struct S2 {
    bytes32 b1;
    bytes32 b2;
  }

  struct X {
    S1 s1;
    S2 s2;
    address[] users;
  }

  function update(X memory x) public {
    addr = x.s1.a2;
  }

  function retrieve() public view returns (address) {
    return addr;
  }
}
</pre></div>
</div>
<p>You can interact with the web3.py contract API as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># deploy or lookup the deployed contract, then:</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">deployed_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">retrieve</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="s1">&#39;0x0000000000000000000000000000000000000000&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">deployed_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0x0000000000000000000000000000000000000001&#39;</span><span class="p">,</span> <span class="s1">&#39;0x0000000000000000000000000000000000000002&#39;</span><span class="p">],</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">],</span> <span class="s1">&#39;users&#39;</span><span class="p">:</span> <span class="p">[]})</span><span class="o">.</span><span class="n">transact</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">deployed_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">retrieve</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="s1">&#39;0x0000000000000000000000000000000000000002&#39;</span>
</pre></div>
</div>
</section>
<section id="invoke-ambiguous-contract-functions">
<span id="ambiguous-contract-functions"></span><h3>Invoke Ambiguous Contract Functions<a class="headerlink" href="#invoke-ambiguous-contract-functions" title="Link to this heading"></a></h3>
<p>Calling overloaded functions can be done as you would expect. Passing arguments will
disambiguate which function you want to call.</p>
<p>For example, if you have a contract with two functions with the name <code class="docutils literal notranslate"><span class="pre">identity</span></code> that
accept different types of arguments, you can call them like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ambiguous_contract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=...</span><span class="p">,</span> <span class="n">abi</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ambiguous_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ambiguous_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>If there is a need to first retrieve the function, you can use the contract instance's
<code class="docutils literal notranslate"><span class="pre">get_function_by_signature</span></code> method to get the function you want to call.</p>
<p>Below is an example of a contract that has multiple functions of the same name,
and the arguments are ambiguous. You can use the <a class="reference internal" href="#web3.contract.Contract.get_function_by_signature" title="web3.contract.Contract.get_function_by_signature"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Contract.get_function_by_signature()</span></code></a>
method to reference the intended function and call it with the correct arguments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contract_source_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="go">pragma solidity ^0.8.24;</span>
<span class="go">contract AmbiguousDuo {</span>
<span class="go">  function identity(uint256 input, bool uselessFlag) public pure returns (uint256) {</span>
<span class="go">    return input;</span>
<span class="go">  }</span>
<span class="go">  function identity(int256 input, bool uselessFlag) public pure returns (int256) {</span>
<span class="go">    return input;</span>
<span class="go">  }</span>
<span class="go">}</span>
<span class="go">&quot;&quot;&quot;</span>
<span class="go"># fast forward all the steps of compiling and deploying the contract.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="s2">identity_func = ambiguous_contract.get_function_by_signature(&#39;identity(uint256,bool)&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">identity_func(1, True)</span>
<span class="go">&lt;Function identity(uint256,bool) bound to (1, True)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">identity_func(1, True).call()</span>
<span class="go">1</span>
</pre></div>
</div>
</section>
<section id="ccip-read-support-for-offchain-lookup">
<span id="ccip-read-example"></span><h3>CCIP Read support for offchain lookup<a class="headerlink" href="#ccip-read-support-for-offchain-lookup" title="Link to this heading"></a></h3>
<p>Contract calls support CCIP Read by default, via a <code class="docutils literal notranslate"><span class="pre">ccip_read_enabled</span></code> flag on the call and, more globally, a
<code class="docutils literal notranslate"><span class="pre">global_ccip_read_enabled</span></code> flag on the provider. The following should work by default without raising an
<code class="docutils literal notranslate"><span class="pre">OffchainLookup</span></code> and instead handling it appropriately as per the specification outlined in
<a class="reference external" href="https://eips.ethereum.org/EIPS/eip-3668">EIP-3668</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">revertsWithOffchainLookup</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
</pre></div>
</div>
<p>If the offchain lookup requires the user to send a transaction rather than make a call, this may be handled
appropriately in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">web3</span><span class="w"> </span><span class="kn">import</span> <span class="n">Web3</span><span class="p">,</span> <span class="n">WebSocketProvider</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">web3.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">handle_offchain_lookup</span>

<span class="n">w3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">WebSocketProvider</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>

<span class="n">myContract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">address</span><span class="o">=...</span><span class="p">)</span>
<span class="n">myData</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;data for offchain lookup function call&#39;</span>

<span class="c1"># preflight with an `eth_call` and handle the exception</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">myContract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">revertsWithOffchainLookup</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">ccip_read_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">except</span> <span class="n">OffchainLookup</span> <span class="k">as</span> <span class="n">ocl</span><span class="p">:</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="n">myContract</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="n">my_account</span><span class="p">}</span>
    <span class="n">data_for_callback_function</span> <span class="o">=</span> <span class="n">handle_offchain_lookup</span><span class="p">(</span><span class="n">ocl</span><span class="o">.</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">tx</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_for_callback_function</span>

    <span class="c1"># send the built transaction with `eth_sendTransaction` or sign and send with `eth_sendRawTransaction`</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">send_transaction</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="contract-unit-tests-in-python">
<h3>Contract Unit Tests in Python<a class="headerlink" href="#contract-unit-tests-in-python" title="Link to this heading"></a></h3>
<p>Here is an example of how one can use the <a class="reference external" href="https://docs.pytest.org/en/latest/">pytest</a> framework in python, web3.py,
eth-tester, and PyEVM to perform unit tests entirely in python without any
additional need for a full featured ethereum node/client. To install needed
dependencies you can use the pinned extra for testing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>web3<span class="o">[</span>test<span class="o">]</span><span class="w"> </span>pytest
</pre></div>
</div>
<p>Once you have an environment set up for testing, you can then write your tests
like so:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># of how to write unit tests with web3.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pytest_asyncio</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">web3</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">AsyncWeb3</span><span class="p">,</span>
    <span class="n">EthereumTesterProvider</span><span class="p">,</span>
    <span class="n">Web3</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">web3.providers.eth_tester.main</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">AsyncEthereumTesterProvider</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tester_provider</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">EthereumTesterProvider</span><span class="p">()</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">eth_tester</span><span class="p">(</span><span class="n">tester_provider</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tester_provider</span><span class="o">.</span><span class="n">ethereum_tester</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">w3</span><span class="p">(</span><span class="n">tester_provider</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Web3</span><span class="p">(</span><span class="n">tester_provider</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">foo_contract</span><span class="p">(</span><span class="n">eth_tester</span><span class="p">,</span> <span class="n">w3</span><span class="p">):</span>
    <span class="c1"># For simplicity of this example we statically define the</span>
    <span class="c1"># contract code here. You might read your contracts from a</span>
    <span class="c1"># file, or something else to test with in your own code</span>
    <span class="c1">#</span>
    <span class="c1"># pragma solidity^0.5.3;</span>
    <span class="c1">#</span>
    <span class="c1"># contract Foo {</span>
    <span class="c1">#</span>
    <span class="c1">#     string public bar;</span>
    <span class="c1">#     event barred(string _bar);</span>
    <span class="c1">#</span>
    <span class="c1">#     constructor() public {</span>
    <span class="c1">#         bar = &quot;hello world&quot;;</span>
    <span class="c1">#     }</span>
    <span class="c1">#</span>
    <span class="c1">#     function setBar(string memory _bar) public {</span>
    <span class="c1">#         bar = _bar;</span>
    <span class="c1">#         emit barred(_bar);</span>
    <span class="c1">#     }</span>
    <span class="c1">#</span>
    <span class="c1"># }</span>

    <span class="n">deploy_address</span> <span class="o">=</span> <span class="n">eth_tester</span><span class="o">.</span><span class="n">get_accounts</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">abi</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;[{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;_bar&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;barred&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_bar&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;setBar&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;constructor&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;bar&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;}]&quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="c1"># This bytecode is the output of compiling with</span>
    <span class="c1"># solc version:0.5.3+commit.10d17f24.Emscripten.clang</span>
    <span class="n">bytecode</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;608060405234801561001057600080fd5b506040805190810160405280600b81526020017f68656c6c6f20776f726c640000000000000000000000000000000000000000008152506000908051906020019061005c929190610062565b50610107565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100a357805160ff19168380011785556100d1565b828001600101855582156100d1579182015b828111156100d05782518255916020019190600101906100b5565b5b5090506100de91906100e2565b5090565b61010491905b808211156101005760008160009055506001016100e8565b5090565b90565b6103bb806101166000396000f3fe608060405234801561001057600080fd5b5060043610610053576000357c01000000000000000000000000000000000000000000000000000000009004806397bc14aa14610058578063febb0f7e14610113575b600080fd5b6101116004803603602081101561006e57600080fd5b810190808035906020019064010000000081111561008b57600080fd5b82018360208201111561009d57600080fd5b803590602001918460018302840111640100000000831117156100bf57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610196565b005b61011b61024c565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561015b578082015181840152602081019050610140565b50505050905090810190601f1680156101885780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b80600090805190602001906101ac9291906102ea565b507f5f71ad82e16f082de5ff496b140e2fbc8621eeb37b36d59b185c3f1364bbd529816040518080602001828103825283818151815260200191508051906020019080838360005b8381101561020f5780820151818401526020810190506101f4565b50505050905090810190601f16801561023c5780820380516001836020036101000a031916815260200191505b509250505060405180910390a150565b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156102e25780601f106102b7576101008083540402835291602001916102e2565b820191906000526020600020905b8154815290600101906020018083116102c557829003601f168201915b505050505081565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061032b57805160ff1916838001178555610359565b82800160010185558215610359579182015b8281111561035857825182559160200191906001019061033d565b5b509050610366919061036a565b5090565b61038c91905b80821115610388576000816000905550600101610370565b5090565b9056fea165627a7a72305820ae6ca683d45ee8a71bba45caee29e4815147cd308f772c853a20dfe08214dbb50029&quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>

    <span class="c1"># Create our contract class.</span>
    <span class="n">FooContract</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">abi</span><span class="o">=</span><span class="n">abi</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">=</span><span class="n">bytecode</span><span class="p">)</span>
    <span class="c1"># issue a transaction to deploy the contract.</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="n">FooContract</span><span class="o">.</span><span class="n">constructor</span><span class="p">()</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">deploy_address</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># wait for the transaction to be mined</span>
    <span class="n">tx_receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
    <span class="c1"># instantiate and return an instance of our contract.</span>
    <span class="k">return</span> <span class="n">FooContract</span><span class="p">(</span><span class="n">tx_receipt</span><span class="o">.</span><span class="n">contractAddress</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_initial_greeting</span><span class="p">(</span><span class="n">foo_contract</span><span class="p">):</span>
    <span class="n">hw</span> <span class="o">=</span> <span class="n">foo_contract</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">hw</span> <span class="o">==</span> <span class="s2">&quot;hello world&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_can_update_greeting</span><span class="p">(</span><span class="n">w3</span><span class="p">,</span> <span class="n">foo_contract</span><span class="p">):</span>
    <span class="c1"># send transaction that updates the greeting</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="n">foo_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBar</span><span class="p">(</span><span class="s2">&quot;testing contracts is easy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>

    <span class="c1"># verify that the contract is now using the updated greeting</span>
    <span class="n">hw</span> <span class="o">=</span> <span class="n">foo_contract</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">hw</span> <span class="o">==</span> <span class="s2">&quot;testing contracts is easy&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_updating_greeting_emits_event</span><span class="p">(</span><span class="n">w3</span><span class="p">,</span> <span class="n">foo_contract</span><span class="p">):</span>
    <span class="c1"># send transaction that updates the greeting</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="n">foo_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBar</span><span class="p">(</span><span class="s2">&quot;testing contracts is easy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">receipt</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>

    <span class="c1"># get all of the `barred` logs for the contract</span>
    <span class="n">logs</span> <span class="o">=</span> <span class="n">foo_contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">barred</span><span class="o">.</span><span class="n">get_logs</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="c1"># verify that the log&#39;s data matches the expected value</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">logs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">blockHash</span> <span class="o">==</span> <span class="n">receipt</span><span class="o">.</span><span class="n">blockHash</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">_bar</span> <span class="o">==</span> <span class="s2">&quot;testing contracts is easy&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">async_eth_tester</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">AsyncEthereumTesterProvider</span><span class="p">()</span><span class="o">.</span><span class="n">ethereum_tester</span>


<span class="nd">@pytest_asyncio</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_w3</span><span class="p">():</span>
    <span class="n">async_w3</span> <span class="o">=</span> <span class="n">AsyncWeb3</span><span class="p">(</span><span class="n">AsyncEthereumTesterProvider</span><span class="p">())</span>
    <span class="n">accounts</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">accounts</span>
    <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">default_account</span> <span class="o">=</span> <span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">async_w3</span>


<span class="nd">@pytest_asyncio</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_foo_contract</span><span class="p">(</span><span class="n">async_w3</span><span class="p">):</span>
    <span class="c1"># For simplicity of this example we statically define the</span>
    <span class="c1"># contract code here. You might read your contracts from a</span>
    <span class="c1"># file, or something else to test with in your own code</span>
    <span class="c1">#</span>
    <span class="c1"># pragma solidity^0.5.3;</span>
    <span class="c1">#</span>
    <span class="c1"># contract Foo {</span>
    <span class="c1">#</span>
    <span class="c1">#     string public bar;</span>
    <span class="c1">#     event barred(string _bar);</span>
    <span class="c1">#</span>
    <span class="c1">#     constructor() public {</span>
    <span class="c1">#         bar = &quot;hello world&quot;;</span>
    <span class="c1">#     }</span>
    <span class="c1">#</span>
    <span class="c1">#     function setBar(string memory _bar) public {</span>
    <span class="c1">#         bar = _bar;</span>
    <span class="c1">#         emit barred(_bar);</span>
    <span class="c1">#     }</span>
    <span class="c1">#</span>
    <span class="c1"># }</span>

    <span class="n">abi</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;[{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;_bar&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;barred&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_bar&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;setBar&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;constructor&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;bar&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;}]&quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="c1"># This bytecode is the output of compiling with</span>
    <span class="c1"># solc version:0.5.3+commit.10d17f24.Emscripten.clang</span>
    <span class="n">bytecode</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;608060405234801561001057600080fd5b506040805190810160405280600b81526020017f68656c6c6f20776f726c640000000000000000000000000000000000000000008152506000908051906020019061005c929190610062565b50610107565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100a357805160ff19168380011785556100d1565b828001600101855582156100d1579182015b828111156100d05782518255916020019190600101906100b5565b5b5090506100de91906100e2565b5090565b61010491905b808211156101005760008160009055506001016100e8565b5090565b90565b6103bb806101166000396000f3fe608060405234801561001057600080fd5b5060043610610053576000357c01000000000000000000000000000000000000000000000000000000009004806397bc14aa14610058578063febb0f7e14610113575b600080fd5b6101116004803603602081101561006e57600080fd5b810190808035906020019064010000000081111561008b57600080fd5b82018360208201111561009d57600080fd5b803590602001918460018302840111640100000000831117156100bf57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610196565b005b61011b61024c565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561015b578082015181840152602081019050610140565b50505050905090810190601f1680156101885780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b80600090805190602001906101ac9291906102ea565b507f5f71ad82e16f082de5ff496b140e2fbc8621eeb37b36d59b185c3f1364bbd529816040518080602001828103825283818151815260200191508051906020019080838360005b8381101561020f5780820151818401526020810190506101f4565b50505050905090810190601f16801561023c5780820380516001836020036101000a031916815260200191505b509250505060405180910390a150565b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156102e25780601f106102b7576101008083540402835291602001916102e2565b820191906000526020600020905b8154815290600101906020018083116102c557829003601f168201915b505050505081565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061032b57805160ff1916838001178555610359565b82800160010185558215610359579182015b8281111561035857825182559160200191906001019061033d565b5b509050610366919061036a565b5090565b61038c91905b80821115610388576000816000905550600101610370565b5090565b9056fea165627a7a72305820ae6ca683d45ee8a71bba45caee29e4815147cd308f772c853a20dfe08214dbb50029&quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>

    <span class="c1"># Create our contract class.</span>
    <span class="n">FooContract</span> <span class="o">=</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">abi</span><span class="o">=</span><span class="n">abi</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">=</span><span class="n">bytecode</span><span class="p">)</span>
    <span class="c1"># issue a transaction to deploy the contract.</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="k">await</span> <span class="n">FooContract</span><span class="o">.</span><span class="n">constructor</span><span class="p">()</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">default_account</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># wait for the transaction to be mined</span>
    <span class="n">tx_receipt</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
    <span class="c1"># instantiate and return an instance of our contract.</span>
    <span class="k">return</span> <span class="n">FooContract</span><span class="p">(</span><span class="n">tx_receipt</span><span class="p">[</span><span class="s2">&quot;contractAddress&quot;</span><span class="p">])</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_async_initial_greeting</span><span class="p">(</span><span class="n">async_foo_contract</span><span class="p">):</span>
    <span class="n">hw</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_foo_contract</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">hw</span> <span class="o">==</span> <span class="s2">&quot;hello world&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_async_can_update_greeting</span><span class="p">(</span><span class="n">async_w3</span><span class="p">,</span> <span class="n">async_foo_contract</span><span class="p">):</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_foo_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBar</span><span class="p">(</span>
        <span class="s2">&quot;testing contracts is easy&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">default_account</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>

    <span class="c1"># verify that the contract is now using the updated greeting</span>
    <span class="n">hw</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_foo_contract</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">hw</span> <span class="o">==</span> <span class="s2">&quot;testing contracts is easy&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_async_updating_greeting_emits_event</span><span class="p">(</span><span class="n">async_w3</span><span class="p">,</span> <span class="n">async_foo_contract</span><span class="p">):</span>
    <span class="c1"># send transaction that updates the greeting</span>
    <span class="n">tx_hash</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_foo_contract</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">setBar</span><span class="p">(</span>
        <span class="s2">&quot;testing contracts is easy&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transact</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">default_account</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">receipt</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">wait_for_transaction_receipt</span><span class="p">(</span><span class="n">tx_hash</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>

    <span class="c1"># get all of the `barred` logs for the contract</span>
    <span class="n">logs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_foo_contract</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">barred</span><span class="o">.</span><span class="n">get_logs</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="c1"># verify that the log&#39;s data matches the expected value</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">logs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">blockHash</span> <span class="o">==</span> <span class="n">receipt</span><span class="o">.</span><span class="n">blockHash</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">_bar</span> <span class="o">==</span> <span class="s2">&quot;testing contracts is easy&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="transactions.html" class="btn btn-neutral float-left" title="交易" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="filters.html" class="btn btn-neutral float-right" title="事件和日志" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2016-2025, The Ethereum Foundation。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.


</footer>
        </div>
      </div>
    </section>
  </div>

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book fa-element"> RTD </span>

    <span class="fa fa-element">
    <input class="container_toggle" type="checkbox" id="switch" name="mode">
    <label for="switch"></label>
    </span>

    <span class="fa fa-v fa-element"> v:  <span class="fa fa-caret-down"></span></span>

    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>版本</dt>
        </dl>
        <dl>
            <dt>下载</dt>
        </dl>
        <dl>

            <dt>托管于 Read the Docs</dt>
            <dd>
                <a href="///projects//?fromdocs=">项目主页</a>
            </dd>
            <dd>
                <a href="///builds//?fromdocs=">构建</a>
            </dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
